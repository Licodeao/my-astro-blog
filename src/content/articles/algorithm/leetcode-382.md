---
title: Leetcode-382-é“¾è¡¨éšæœºèŠ‚ç‚¹ğŸ“Œ
author: Licodeao
publishDate: 2023-5-25
img: /assets/articles/leetcode.png
img_alt: Leetcode-382-é“¾è¡¨éšæœºèŠ‚ç‚¹ğŸ“Œ
description: |
  Leetcode-382-é“¾è¡¨éšæœºèŠ‚ç‚¹ğŸ“Œ
categories:
  - Algorithm
tags:
  - Algorithm
---

## 382. é“¾è¡¨éšæœºèŠ‚ç‚¹

ç»™ä½ ä¸€ä¸ªå•é“¾è¡¨ï¼Œéšæœºé€‰æ‹©é“¾è¡¨çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›ç›¸åº”çš„èŠ‚ç‚¹å€¼ã€‚æ¯ä¸ªèŠ‚ç‚¹ **è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸€æ ·** ã€‚

å®ç° `Solution` ç±»ï¼š

- `Solution(ListNode head)` ä½¿ç”¨æ•´æ•°æ•°ç»„åˆå§‹åŒ–å¯¹è±¡ã€‚
- `int getRandom()` ä»é“¾è¡¨ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹å¹¶è¿”å›è¯¥èŠ‚ç‚¹çš„å€¼ã€‚é“¾è¡¨ä¸­æ‰€æœ‰èŠ‚ç‚¹è¢«é€‰ä¸­çš„æ¦‚ç‡ç›¸ç­‰ã€‚

**ç¤ºä¾‹ï¼š**

![img](https://assets.leetcode.com/uploads/2021/03/16/getrand-linked-list.jpg)

```
è¾“å…¥
["Solution", "getRandom", "getRandom", "getRandom", "getRandom", "getRandom"]
[[[1, 2, 3]], [], [], [], [], []]
è¾“å‡º
[null, 1, 3, 2, 2, 3]

è§£é‡Š
Solution solution = new Solution([1, 2, 3]);
solution.getRandom(); // è¿”å› 1
solution.getRandom(); // è¿”å› 3
solution.getRandom(); // è¿”å› 2
solution.getRandom(); // è¿”å› 2
solution.getRandom(); // è¿”å› 3
// getRandom() æ–¹æ³•åº”éšæœºè¿”å› 1ã€2ã€3ä¸­çš„ä¸€ä¸ªï¼Œæ¯ä¸ªå…ƒç´ è¢«è¿”å›çš„æ¦‚ç‡ç›¸ç­‰ã€‚
```

**æç¤ºï¼š**

- é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ `[1, 104]` å†…
- `-104 <= Node.val <= 104`
- è‡³å¤šè°ƒç”¨ `getRandom` æ–¹æ³• `104` æ¬¡

## è§£é¢˜æ€è·¯

æ³•ä¸€ï¼šç»Ÿè®¡å‡ºé“¾è¡¨çš„é•¿åº¦ nï¼Œéšæœºæ•°ä¸º kï¼ˆé€šè¿‡ random åº“å‡½æ•°çš„æ–¹å¼ï¼‰ï¼Œéšåéå†é“¾è¡¨ï¼Œè¿”å›é“¾è¡¨ä¸­ç¬¬ k ä¸ªèŠ‚ç‚¹å³å¯

- ç”±äºè¦éå†ä¸¤æ¬¡ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(1)

æ³•äºŒï¼šè“„æ°´æŠ½æ ·æ³•ï¼Œéå†åˆ°ç¬¬ k ä¸ªèŠ‚ç‚¹æ—¶ï¼Œä»¥ 1/k çš„æ¦‚ç‡é€‰å®ƒï¼Œå¦‚æœé€‰ä¸­å°±è¿”å›

- å®é™…æ“ä½œæ˜¯é€šè¿‡å˜é‡ä¿å­˜æ¯æ¬¡é€‰ä¸­çš„èŠ‚ç‚¹
- å½“åªæœ‰ 1 ä¸ªèŠ‚ç‚¹æ—¶ï¼Œå…¶è¢«é€‰ä¸­çš„æ¦‚ç‡å°±æ˜¯ 1/1=1ï¼Œè¿”å›
- æœ‰ 2 ä¸ªèŠ‚ç‚¹æ—¶ï¼ˆ1=>2ï¼‰ï¼Œ2 è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º 1/2ï¼Œé‚£ä¹ˆ 1 è¢«é€‰ä¸­çš„æ¦‚ç‡ä¹Ÿä¸º 1/2
- æœ‰ 3 ä¸ªèŠ‚ç‚¹æ—¶ï¼ˆ1=>2=>3ï¼‰ï¼Œ3 è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º 1/3ï¼Œ(1=>2)è¿™ä¸ªæ¦‚ç‡ä¸º 2/3ï¼Œé‚£ä¹ˆ 1 æˆ– 2 è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º 2/3 Ã— 1/2 = 1/3
- æœ‰ 4 ä¸ªèŠ‚ç‚¹æ—¶ï¼ˆ1=>2=>3=>4ï¼‰ï¼Œ4 è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º 1/4ï¼Œ(1=>2=>3=>4)è¿™ä¸ªæ¦‚ç‡ä¸º 3/4ï¼Œé‚£ä¹ˆ 1 æˆ– 2 æˆ– 3 è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º 3/4 Ã— 1/3 = 1/4
- é‚£ä¹ˆï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ‰ k ä¸ªèŠ‚ç‚¹æ—¶ï¼Œk è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º 1/kï¼Œé€‰ä¸­å°±è¿”å›
- å¯¹äºè¯¥æ–¹æ³•æ¥è¯´ï¼Œåªç”¨éå†ä¸€æ¬¡å³å¯

```typescript
// æ³•ä¸€

class Solution {
  // å­˜æ”¾é“¾è¡¨
  private head = null;

  constructor(head: ListNode | null) {
    this.head = head;
  }

  getRandom(): number {
    // ç»Ÿè®¡èŠ‚ç‚¹ä¸ªæ•°
    let n = 1;
    let cur = this.head;
    while (cur.next !== null) {
      n++;
      cur = cur.next;
    }

    cur = this.head;

    let k = Math.floor(Math.random() * n + 1);
    // éå†åˆ°ç¬¬kä¸ªèŠ‚ç‚¹
    for (let i = 1; i < k; i++) {
      cur = cur.next;
    }

    return cur.val;
  }
}
```

```typescript
// æ³•äºŒ

class Solution {
  // å­˜æ”¾é“¾è¡¨
  private head = null;

  constructor(head: ListNode | null) {
    this.head = head;
  }

  getRandom(): number {
    let i = 0;
    let cur = this.head;
    // å­˜æ”¾å½“å‰æ›´æ–°çš„ç»“æœ
    let res = cur.val;
    // æ³¨æ„è¿™é‡Œä¸èƒ½å†™cur.next !== nullï¼Œå› ä¸ºè¿™é“é¢˜çš„æµ‹è¯•ç”¨ä¾‹ä¼šè¿”å›null
    while (cur) {
      i++;
      // ä»¥1/içš„æ¦‚ç‡é€‰ä¸­ï¼Œæ›´æ–°res
      if (Math.floor(Math.random() * i + 1) === i) {
        res = cur.val;
      }
      cur = cur.next;
    }

    return res;
  }
}
```
